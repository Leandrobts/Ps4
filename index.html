<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 WebKit Exploit - Testes Drásticos Isolados</title>
    <style>
        body {
            font-family: monospace;
            white-space: pre-wrap;
        }
        #output {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #f8f8f8;
        }
        .critical { color: magenta; font-weight: bold; }
        .warning { color: orange; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>PS4 WebKit Exploit - Testes Drásticos Isolados</h1>
    <div id="output"></div>

    <script>
        const log = (message, type = 'info') => {
            try {
                const outputDiv = document.getElementById('output');
                if (outputDiv) {
                    outputDiv.innerHTML += `<span class="${type}">${new Date().toLocaleTimeString()} - ${message}\n</span>`;
                } else {
                    console.error('Elemento #output não encontrado!');
                }
            } catch (e) {
                console.error('Erro na função log:', e);
            }
        };

        // --- Teste 1: Blob e FileReader ---
        log("\n--- Teste 1: Blob e FileReader ---", 'critical');
        try {
            const blob = new Blob([new Uint8Array([0x41, 0x42, 0x43])]);
            const reader = new FileReader();
            reader.onloadend = () => {
                log(`FileReader onloadend: ${reader.result}`, 'info');
            };
            reader.onerror = (error) => {
                log(`FileReader onerror: ${error}`, 'error');
            };
            reader.readAsArrayBuffer(blob);
            log("Blob criado e FileReader iniciado.", 'info');
        } catch (error) {
            log(`Erro ao usar Blob/FileReader: ${error}`, 'error');
        }
        log("--- Fim Teste 1 ---", 'critical');

        // --- Teste 2: TextEncoder e TextDecoder ---
        log("\n--- Teste 2: TextEncoder e TextDecoder ---", 'critical');
        try {
            const encoder = new TextEncoder();
            const data = encoder.encode("Hello");
            log(`TextEncoder encode: ${data}`, 'info');
            const decoder = new TextDecoder();
            const text = decoder.decode(data);
            log(`TextDecoder decode: ${text}`, 'info');
            log("TextEncoder e TextDecoder funcionaram.", 'success');
        } catch (error) {
            log(`Erro ao usar TextEncoder/Decoder: ${error}`, 'error');
        }
        log("--- Fim Teste 2 ---", 'critical');

        // --- Teste 3: Tentativa Simples de ArrayBuffer e DataView Inline ---
        log("\n--- Teste 3: ArrayBuffer e DataView Inline Simples ---", 'critical');
        try {
            const buffer = new ArrayBuffer(8);
            log("ArrayBuffer criado.", 'info');
            const dataView = new DataView(buffer);
            log("DataView criado.", 'info');
            dataView.setUint8(0, 0xAA);
            log("Escrita em DataView realizada.", 'success');
        } catch (error) {
            log(`Erro em ArrayBuffer/DataView inline: ${error}`, 'error');
        }
        log("--- Fim Teste 3 ---", 'critical');

        // --- Teste 4: Tentativa Simples de ArrayBuffer e Uint8Array Inline ---
        log("\n--- Teste 4: ArrayBuffer e Uint8Array Inline Simples ---", 'critical');
        try {
            const buffer = new ArrayBuffer(8);
            log("ArrayBuffer criado.", 'info');
            const uint8View = new Uint8Array(buffer);
            log("Uint8Array criado.", 'info');
            uint8View[0] = 0xBB;
            log("Escrita em Uint8Array realizada.", 'success');
        } catch (error) {
            log(`Erro em ArrayBuffer/Uint8Array inline: ${error}`, 'error');
        }
        log("--- Fim Teste 4 ---", 'critical');

    </script>
</body>
</html>
