<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 WebKit Malicious Code Execution POC (data: URI)</title>
</head>
<body>
    <h1>POC: Execução de Código Malicioso via data: URI</h1>
    <div id="output"></div>

    <script>
        const log = (message) => {
            document.getElementById('output').innerHTML += message + "<br>";
        };

        function executeMaliciousCode() {
            log("Tentando executar código malicioso via data: URI...");
            const maliciousScript = document.createElement('script');
            // Este é um exemplo de código malicioso: tenta acessar localStorage de outra origem (falhará devido ao sandbox, mas demonstra execução)
            const maliciousCode = `
                try {
                    localStorage.setItem('malicious_data', 'attacked!');
                    log("Código malicioso executado: Tentativa de acessar localStorage.");
                } catch (e) {
                    log("Código malicioso executado: Erro ao acessar localStorage (esperado no sandbox).");
                }
                // Aqui, um atacante poderia incluir código para roubar dados, fazer requisições maliciosas, etc.
                alert('CÓDIGO MALICIOSO EXECUTADO!');
            `;
            const base64MaliciousCode = btoa(maliciousCode);
            maliciousScript.src = 'data:text/javascript;base64,' + base64MaliciousCode;
            document.body.appendChild(maliciousScript);
        }

        document.addEventListener('DOMContentLoaded', executeMaliciousCode);
    </script>
</body>
</html>
